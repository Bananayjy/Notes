# 2024-12-31

## 一、派生表&内联视图（子查询实现）

### 1.1 语句实例

```sql
SELECT * 
FROM (
    SELECT 
        '202411' AS account_period, 
        '123' AS emp_id, 
        '郁小烨' AS emp_name, 
        '11' AS emp_code, 
        '123' AS account_unit_id, 
        '卡卡' AS account_unit_name,
        12 AS schedule_value
) AS t;
```

### 1.2 解释

1. **子查询 (Subquery)**: 内部的 `SELECT` 语句生成了一个临时的结果集。这个结果集是一个“虚拟表”，包含了单行数据，列的值分别是 `'202411'`、`'123'`、`'郁小烨'`、`'11'`、`'123'`、`'卡卡'` 和 `12`。
2. **派生表 (Derived Table)**: 在 SQL 中，子查询常常作为一个派生表被用来生成临时数据，然后这个派生表可以被外层查询引用。在这段 SQL 语句中，`AS t` 表示给这个派生表起一个别名 `t`。虽然表中只有一行数据，但它看起来像是一个正常的查询结果。
3. **外部查询**: 外部查询 `SELECT * FROM ...` 会从这个子查询（派生表 `t`）中选择所有列。因为 `t` 只有一行数据，最终的结果也只有这一行数据。

### 1.3 作用

这种语句常常用于在需要一个临时的、硬编码的结果集时使用，比如生成一些测试数据、模拟表格数据，或者进行某些临时计算。

### 1.4 报错示例

```sql
select * from (
select '202411' as account_period, '123' as emp_id, '郁小烨' as emp_name, '11' as emp_code, '123' as account_unit_id, '卡卡' as account_unit_name,
12 as schedule_value )
```

子查询 `SELECT ...` 必须有一个别名，通常用 `AS t`（或者你可以使用任何其他名字）来命名它。这是为了让 SQL 引擎知道如何引用该虚拟表中的字段。在 SQL 中，当你使用子查询时，SQL 引擎需要知道这个临时表的名字。没有子查询别名会导致语法错误，因为 SQL 引擎不知道如何引用这些列。通过使用 `AS t`，我们为这个子查询命名为 `t`，然后你就可以像访问普通表一样访问 `t` 中的字段。

