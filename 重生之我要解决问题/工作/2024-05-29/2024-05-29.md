# 2024-05-29

### 一、代码优化

#### 1.1、原代码：

枚举类

```java
@Getter
@AllArgsConstructor
public enum ScreenEnum {

    SCREEN1("按床位使用率排序", "useRateBed"),
    SCREEN2("按空床数排序", "emptyBed"),
    SCREEN3("按总床数排序", "totalBed"),
    ;

    private String label;

    private String value;
}

```

排序内容

```java
// 根据入参screen筛选条件排序
        List<WardBedInfo> wardBedInfoList = rtn.getWardBedInfoList();

        Map<String, String> screens = bedListDto.getScreen();

        // todo 可优化
        if(CollectionUtil.isNotEmpty(screens)) {
            // 如果有多个值，默认获取第一个值
            String key = screens.keySet().iterator().next();
            String value = screens.get(key);

            if(ScreenEnum.SCREEN1.getValue().equals(key)){
                // 按床位使用率排序
                if(OrderEnum.DESC.getVal().equals(value)){
                    wardBedInfoList = wardBedInfoList.stream().sorted(Comparator.comparing(WardBedInfo::getUseRate).thenComparing(WardBedInfo::getWardName))
                            .collect(Collectors.toList());
                } else if (OrderEnum.ASC.getVal().equals(value)) {
                    wardBedInfoList = wardBedInfoList.stream().sorted(Comparator.comparing(WardBedInfo::getUseRate).reversed().thenComparing(WardBedInfo::getWardName))
                            .collect(Collectors.toList());
                }

            } else if (ScreenEnum.SCREEN2.getValue().equals(key)) {
                // 按总床数排序
                if(OrderEnum.DESC.getVal().equals(value)){
                    wardBedInfoList = wardBedInfoList.stream().sorted(Comparator.comparing(WardBedInfo::getTotalBedNum).thenComparing(WardBedInfo::getWardName))
                            .collect(Collectors.toList());
                } else if (OrderEnum.ASC.getVal().equals(value)) {
                    wardBedInfoList = wardBedInfoList.stream().sorted(Comparator.comparing(WardBedInfo::getTotalBedNum).reversed().thenComparing(WardBedInfo::getWardName))
                            .collect(Collectors.toList());
                }
            } else if(ScreenEnum.SCREEN3.getValue().equals(key)) {
                // 按空床数排序
                if(OrderEnum.DESC.getVal().equals(value)){
                    wardBedInfoList = wardBedInfoList.stream().sorted(Comparator.comparing(WardBedInfo::getEmptyBedNum).thenComparing(WardBedInfo::getWardName))
                            .collect(Collectors.toList());
                } else if (OrderEnum.ASC.getVal().equals(value)) {
                    wardBedInfoList = wardBedInfoList.stream().sorted(Comparator.comparing(WardBedInfo::getEmptyBedNum).reversed().thenComparing(WardBedInfo::getWardName))
                            .collect(Collectors.toList());
                }
            }
        }
```



#### 1.2、优化

枚举类

```java
@Getter
@AllArgsConstructor
public enum ScreenEnum {

    SCREEN1("按床位使用率排序", "useRateBed"),
    SCREEN2("按空床数排序", "emptyBed"),
    SCREEN3("按总床数排序", "totalBed"),
    ;

    private String label;

    private String value;


    // 根据排序类型获取对应的排序字段
    public static Comparator getCompatatorByScreenType(String value, String orderVal) {

        Comparator<WardBedInfo> comparator = null;

        if(SCREEN1.getValue().equals(value)) {
            // 按床位使用率排序
            comparator = Comparator.comparing(WardBedInfo::getUseRate);
        } else if(SCREEN2.getValue().equals(value)) {
            // 按床位数排序
            comparator = Comparator.comparing(WardBedInfo::getTotalBedNum);
        } else if(SCREEN3.getValue().equals(value)) {
            // 按空床数排序
            comparator = Comparator.comparing(WardBedInfo::getEmptyBedNum);
        }

        // 升降序控制
        if(OrderEnum.ASC.getVal().equals(orderVal)) {
            comparator = comparator.reversed();
        }

        // 默认按照病区名称排序
        comparator = comparator.thenComparing(WardBedInfo::getWardName);

        return comparator;
    }

}
```



实现

```java
// 根据入参screen筛选条件排序
List<WardBedInfo> wardBedInfoList = rtn.getWardBedInfoList();

Map<String, String> screens = bedListDto.getScreen();

// todo 可优化
if(CollectionUtil.isNotEmpty(screens)) {
    // 如果有多个值，默认获取第一个筛选内容
    String key = screens.keySet().iterator().next();
    String value = screens.get(key);

    Comparator comparator = ScreenEnum.getCompatatorByScreenType(key, value);
    wardBedInfoList = (List<WardBedInfo>) wardBedInfoList.stream().sorted(comparator).collect(Collectors.toList());
}
```

