## 2024-06-13

### 1、MYSQL中的FIND_IN_SET方法

在 MySQL 中，`FIND_IN_SET` 函数用于查找一个字符串在一个由逗号分隔的字符串列表中的位置。它通常用于查询某个值是否存在于一个逗号分隔的字符串集合中。结合 `REPLACE` 函数，可以实现去除空格后再进行查找的功能。

假设你有一个表 `ums`，其中有一个字段 `manage_scope` 存储的是逗号分隔的部门ID列表，并且这些ID可能包含空格。你想要检查 `#{dto.deptId}` 是否在这个列表中。在 MySQL 中可以这样写：

```
sql复制代码SELECT *
FROM ums
WHERE FIND_IN_SET(#{dto.deptId}, REPLACE(ums.manage_scope, ' ', ''))
```

这段 SQL 做了以下几件事：

1. `REPLACE(ums.manage_scope, ' ', '')`：去除 `manage_scope` 字段中的所有空格。
2. `FIND_IN_SET(#{dto.deptId}, REPLACE(ums.manage_scope, ' ', ''))`：在去除空格后的 `manage_scope` 中查找 `#{dto.deptId}`。



### 2、关于nohup java -Xms512m -Xmx1024m -Djava.security.egd=file:/dev/./urandom -jar /app/hs-ward.jar > /app/logs/hs-ward.jar.log 2>&1 &导致logback.xml不生效的问题

logback.xml比nohup重定向有更高的优先级。



关于 2>&1 是将错误输出重定向到标准输出中去

关于三个文件描述符：标准输入、标准输出、标准错误可以查看如下文章

- https://blog.csdn.net/zhanghuaichao/article/details/122983306

- https://blog.csdn.net/chanmufeng/article/details/127034691



关于nohup java -Xms512m -Xmx1024m -Djava.security.egd=file:/dev/./urandom -jar /app/hs-ward.jar & 和 java -Xms512m -Xmx1024m -Djava.security.egd=file:/dev/./urandom -jar /app/hs-ward.jar & 区别：

1. `nohup java -Xms512m -Xmx1024m -Djava.security.egd=file:/dev/./urandom -jar /app/hs-ward.jar &`：
   - `nohup` 命令用于在后台运行命令，并且不受终端关闭的影响。它会将命令的标准输出和标准错误输出都重定向到一个名为 `nohup.out` 的文件中，除非另有指定。
   - 所以，使用 `nohup` 命令启动 Java 程序后，即使关闭了终端，程序仍然会在后台继续运行，并且将输出重定向到 `nohup.out` 文件中。
   - 这种方式适合长时间运行的程序或者需要在后台持续运行的任务，如服务器程序等。
2. `java -Xms512m -Xmx1024m -Djava.security.egd=file:/dev/./urandom -jar /app/hs-ward.jar &`：
   - 这是普通的后台运行 Java 程序的命令，没有使用 `nohup` 命令。
   - 在这种情况下，程序的标准输出和标准错误输出会被重定向到当前终端，除非你手动将其重定向到其他地方，例如使用 `>` 或 `2>&1`。

两种方式都是用于在后台执行命令，但它们之间的主要区别在于后台执行后的行为以及输出的处理方式

`&` 符号的作用是将命令放置在后台执行，而不阻塞当前终端的操作。这使得你可以同时在同一个终端中执行多个命令或程序，而不必等待每个命令或程序完成才能执行下一个

如果你在 Linux 或 Unix 系统上执行该命令，并且没有使用 `nohup` 命令，关闭终端会导致与该终端相关的所有子进程（包括后台运行的 Java 程序）被终止。这意味着关闭终端后，该 Java 程序也会被终止。

如果你使用的是 `nohup` 命令来启动 Java 程序，并且关闭了终端，那么该程序会继续在后台运行。`nohup` 命令会使得程序忽略 SIGHUP 信号，从而不会受到终端关闭的影响。此时，程序会继续在后台执行，直到完成或手动终止。



### 3、@EnableConfigurationProperties(CommonMediaProperties.class)和 自动配置加载并存的情况



```
Description:

Field mediaService in com.hscloud.urgent.controller.UrgentDetailController required a single bean, but 2 were found:
	- com.pig4cloud.pigx.common.media.config.CommonMediaProperties: defined in BeanDefinition defined in null
	- media-com.pig4cloud.pigx.common.media.config.CommonMediaProperties: defined in unknown location

```

