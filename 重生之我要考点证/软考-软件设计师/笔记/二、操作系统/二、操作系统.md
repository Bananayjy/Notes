## 二、操作系统

### 1、进程管理

#### 1.1 操作系统概述

**操作系统定义：**

能有效地组织和管理系统中的各种软/硬件资源，合理地组织计算机系统工作流程，控制程序的执行，并且向用户提供一个良好的工作环境和友好的接口。（PC上：Windows、Linux等移动端上：安卓、IOS等）

**操作系统两个重要作用：**

- 通过资源管理（软硬件管理，不止管理软件，也管理软件，操作系统属于系统软件，与系统软件相区分的是应用软件：如淘宝等）提供计算机系统的效率
- 改善人机界面向用户提供友好的工作环境（Dos、Linux一般采用命令行的方式）

**操作系统特征（4个）：**

- 并发性：对用户来说感觉是并行的（微观交替进行，并行是同一时刻一起执行），在操作系统中CPU是交替执行应用
- 共享性：操作系统中的资源是共享的
- 虚拟性：和设备管理有关，独占设备转换为共享资源
- 不确定性：异步性，同一个程序执行两边结果可能不一样

**操作系统功能：**

- 进程管理：实质上是对处理机（CPU）的执行“时间”进行管理，采用多道程序等技术将CPU的时间合理地分配给每个任务，主要包括进程控制、进程同步、进程通信和进程调度。
- 文件管理：主要包括文件存储空间管理、目录管理、文件的读/写管理和存取控制。
- 存储管理：存储管理是对主存储器（辅存管理就是文件管理）“空间”进行管理，主要包括存储分配与回收、存储保护、地址映射(变换)和主存扩充。
- 设备管理：实质是对硬件设备的管理，包括对输入/输出设备的分配、启(4)动、完成和回收。
- 作业管理：包括任务、界面管理、人机交互、图形界面、语音控制和虚拟现实等。

**操作系统分类：**

- 批处理操作系统: 不用人为操作，即一次处理100个，只需要设定一下程序，程序就会一个一个去处理。单道批处理（一个处理完才会处理下一个）和多道批处理(同时处理多个任务，主机与外设可并行)
- 分时操作系统:一个计算机系统与多个终端设备连接。将CPU的工作时间划分为许多很短的时间片，轮流（不能让一个长时间占用执行，否则其他就不能运行了）为各个终端的用户服务，感觉上，各个终端同时在使用该操作系统，对交互能力要求高。
- 实时操作系统:实时是指计算机对于外来信息能够以足够快的速度进行处理并在被控对象允许的时间范围内做出快速反应。实时系统对交互能力要求不高，但要求可靠性有保障。
- 网络操作系统:是使联网计算机能方便而有效地共享网络资源，为网络用户提供各种服务的软件和有关协议的集合。三种模式:集中模式（有个集中的计算器来共享）、客户端/服务器模式（即C/S）、对等模式（PPP，整个网络中计算机都是平等的，既可以作为客户端，也可以作为服务器）。
- 分布式操作系统：（网络操作系统的升级，区别就是网络操作系统中的各个计算机都处于一个网络中），分布式计算机系统是由多个分散的计算机经连接而成的计算机系统，系统中的计算机无主、次之分，任意两台计算机可以通过通信交换信息。
- 微型计算机操作系统:（我们生活中常用的）简称微机操作系统，常用的有Windows、Mac OS、Linux.

**嵌入式操作系统特点**

嵌入式操作系统：嵌入到智能设备中的系统。（通俗）

- 微型化。从性能和成本角度考虑，希望占用的资源和系统代码量少，如内存少、字长短、运行速度有限、能源少(用微小型电池)。（像PC端中Windows系统的话，就需要4GB左右大小，很大）
- 可定制。从减少成本和缩短研发周期考虑，要求嵌入式操作系统能运行在不同的微处理器平台上，能针对硬件变化（不同设备硬件不同，不像PC那么固定，只有CPU、内存……构成，如空调的话就需要制冷机等）进行结构与功能上的配置，以满足不同应用需要。
- 实时性。嵌入式操作系统主要应用于过程控制、数据采集、传输通信、多媒体信息及关键要害领域需要迅速响应的场合，所以对实时性要求较高。
- 可靠性。系统构件、模块和体系结构必须达到应有的可靠性，对关键要害应用还要提供容错和防故障措施。
- 易移植性。为了提高系统的易移植性，通常采用硬件抽象层和板级支撑包的底层设计技术

嵌入式系统初始化过程按照自底向上、从硬件到软件的次序依次为:片级初始化（芯片级别的初始化）→板级初始化（板上各种外设吃刷）→系统初始化（操作系统初始化）。个人PC的启动也是有启动顺序：硬件启动->BIOS(烧在主板上的固化程序)->系统初始化

#### 1.2 进程组成和状态

**进程组成：**

- 进程控制块PCB（process controller block唯一标志）
- 程序（描述进程要做什么）
- 数据（存放进程执行时所需数据）

**三态图：**进程三态之间转换如左图所示（右侧五态图不要求掌握）

![image-20250227230830476](%E4%BA%8C%E3%80%81%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.assets/image-20250227230830476.png)

- 运行态：需要CPU资源进行运行
- 就绪态：除了CPU，其他需要的资源都有了
- 阻塞：除了CPU，还缺其他条件（如外设需要传输数据，即IO操作，速度比较慢，需要把CPU让出去）

扩展：

- 新建：新建一个进程后，还没有分配到就绪队列中
- 终止：运行完了，还要释放一些资源



> 真题：AC
>
> ![image-20250303235018238](%E4%BA%8C%E3%80%81%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.assets/image-20250303235018238.png)



#### 1.3 前驱图

用来表示哪些任务可以并行执行，哪些任务之间有顺序关系，具体如下图:可知，ABC可以并行执行，但是必须ABC都执行完后，才能执行D，这就确定了两点:任务间的并行、任务间的先后顺序

![image-20250303235112828](%E4%BA%8C%E3%80%81%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.assets/image-20250303235112828.png)



#### 1.4 进程资源图

用来表示进程和资源之间的分配和请求关系，，如下图所示

![image-20250303235323848](%E4%BA%8C%E3%80%81%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.assets/image-20250303235323848.png)

- P代表进程，R代表资源，R方框中有几个圆球就表示有几个这种资源，在上图中，R1指向P1，表示R1有一个资源已经分配给了P1，P1指向R2，表示P1还需要请求一个R2资源才能执行，
- 阻塞节点:某进程所请求的资源已经全部分配完毕，无法获取所需资源，该进程被阻塞了无法继续。如上图中P2。
- 非阻塞节点:某进程所请求的资源还有剩余，可以分配给该进程继续运行。如上图中P1、P3。
- 当一个进程资源图中所有进程都是阻塞节点时，即陷入死锁状态



真题：CB

![image-20250304222352901](%E4%BA%8C%E3%80%81%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.assets/image-20250304222352901.png)![image-20250304222413820](%E4%BA%8C%E3%80%81%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.assets/image-20250304222413820.png)



#### 1.5 进程同步或互斥

一些概念：

- 临界资源:各进程间需要以互斥方式对其进行访问的资源。

- 临界区:指进程中对临界资源实施操作的那段程序。本质是一段程序代码。
- 互斥:某资源(即临界资源)在同一时间内只能由一个任务单独使用，使用时需要加锁，使用完后解锁才能被其他任务使用。如打印机。
- 同步:多个任务可以并发执行，只不过有速度上的差异，在一定情况下停下等待，不存在资源是否单独或共享的问题。如A—>B,可以选择自行车和汽车，但是汽车先到要等待自行车一起到了再去做后面的事情。
- 互斥信号量:对临界资源采用互斥访问，使用互斥信号量后其他进程无法访问，初值为1。
- 同步信号量:对共享资源的访问控制（有数量上限，需要控制），初值一般是共享资源的数量



对于信号量的操作：

S是信号量（包括互斥信号量和同步信号量），当S大于0表示资源的个数，当S小于0表示有多少个进程等待这个资源。

- P操作：申请资源，S = S - 1,若S>0,则执行P操作的进程继续执行；若S<0,则置该进程为阻塞状态（因为无可用资源），并将其插入阻塞队列。
- V操作：释放资源，S=S+1，若S>0，则执行V操作的进程继续执行:若S<=0，则从阻塞状态唤醒一个进程，并将其插入就绪队列(此时因为缺少资源被P操作阻塞的进程可以继续执行)，然后执行V操作的进程继续。

![image-20250304223622723](%E4%BA%8C%E3%80%81%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.assets/image-20250304223622723.png)





金典问题：

![image-20250304224632284](%E4%BA%8C%E3%80%81%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.assets/image-20250304224632284.png)

互斥信号量需要配套，一一对应，即 有P就要V

同步信号量没事



真题：

![image-20250304224610355](%E4%BA%8C%E3%80%81%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.assets/image-20250304224610355.png)







#### 1.6 进程调度

#### 1.7 死锁

#### 1.8 线程









### 2、存储管理

#### 2.1 分区存储管理

#### 2.2 分页存储管理

#### 2.3 分段存储管理

#### 2.4 段页式存储管理

### 3、设备管理

#### 3.1 设备管理概述

#### 3.2 I/O软件

#### 3.3 设备管理技术

### 4、文件管理

#### 4.1 文件管理概述

#### 4.2 索引文件结构

#### 4.3 文件目录

#### 4.4 文件存储空间管理



