## 03、虚拟机与Java虚拟机

### 3.1、虚拟机概念

所谓虚拟机(Virtual Machine)，就是一台虚拟的计算机。它是一款软件，用来执行一系列虚拟计算机指令。大体上，虚拟机可以分为`系统虚拟机`和`程序虚拟机`。

- 大名鼎鼎的visual Box，VMware就属于系统虚拟机，它们完全是对物理计算机的仿真（cpu、硬盘……，对硬件的模拟），提供了一个可运行完整操作系统的软件平台。

- 程序虚拟机的典型代表就是Java虚拟机，它专门为执行单个计算机程序而设计，在Java虚拟机中执行的指令我们称为Java字节码指令。（系统虚拟机上的应用软件）


无论是系统虚拟机还是程序虚拟机，在上面运行的软件都被限制于虚拟机提供的资源中。

### 3.2、Java虚拟机

#### 1.概念说明

- Java虚拟机是一台执行Java字节码的虚拟计算机，它拥有独立的运行机制，其运行的Java字节码也未必由Java语言编译而成。

  即JVM 并不限制字节码一定要由 Java 语言编写，JVM 所能处理的字节码是遵循 Java 虚拟机规范定义的一种通用格式，因此可以由其他编程语言生成的字节码也能在 JVM 上运行。

  1. Kotlin：一种现代的静态类型编程语言，它与 Java 无缝集成，并可以编译成 Java 字节码以在 JVM 上运行。
  2. Scala：一种多范式编程语言，它结合了面向对象编程和函数式编程的特性。Scala 代码也可以编译成 Java 字节码并在 JVM 上执行。
  3. Groovy：一种动态类型的编程语言，它允许在 Java 平台上进行简洁、优雅的编码。Groovy 代码也可以编译成 Java 字节码并在 JVM 上运行。
  4. Clojure：一种 Lisp 方言，它运行在 JVM 上，并将 Lisp 的强大功能与 Java 平台的广泛库集成起来。
  5. JRuby：Ruby 的一个实现，它可以编译成 Java 字节码并在 JVM 上运行。
  6. Jython：Python 的一个实现，同样可以编译成 Java 字节码并在 JVM 上执行。

  因此，JVM 并不局限于只能执行由 Java 编写的字节码文件，而是支持多种编程语言生成的字节码文件。

- JVM平台的各种语言可以共享Java虚拟机带来的跨平台性、优秀的垃圾回器，以及可靠的即时编译器。
- Java技术的核心就是Java虚拟机(JVM，Java virtual Machine)，因为所有的Java程序都运行在Java虚拟机内部

#### 2.作用

Java虚拟机就是二进制字节码的运行环境，负责装载字节码到其内部，解释编译为对应平台上的机器指令执行。每一条Java指令，Java虚拟机规范中都处理结果放在哪里。有详细定义，如怎么取操作数，怎么处理操作数，处理结果放在哪里。（但是，由于内存等管理这些都是JVM帮我们做好了，有很大的风险）

#### 3.特点
- 一次编译，到处运行
- 自动内存管理
- 自动垃圾回收功能



### 3.3、JVM位置

内两层为系统虚拟机（模拟整个计算机硬件，对物理计算机的仿真），JVM为程序虚拟机（专门为执行单个计算机程序而设计，JVM是运行在操作系统之上的，它与硬件没有直接的交互）。

![image-20240529224623412](03%E3%80%81%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%8EJava%E8%99%9A%E6%8B%9F%E6%9C%BA.assets/image-20240529224623412.png)

JVM整体架构

![image-20240529225033019](03%E3%80%81%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%8EJava%E8%99%9A%E6%8B%9F%E6%9C%BA.assets/image-20240529225033019.png)